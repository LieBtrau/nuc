Version 4
SHEET 1 1624 884
WIRE 96 -128 -48 -128
WIRE -624 -16 -816 -16
WIRE -384 -16 -624 -16
WIRE 32 -16 -384 -16
WIRE 96 -16 96 -128
WIRE 96 -16 32 -16
WIRE 256 -16 96 -16
WIRE 304 -16 256 -16
WIRE 448 -16 400 -16
WIRE -624 32 -624 -16
WIRE -384 80 -384 64
WIRE -96 80 -384 80
WIRE -624 112 -688 112
WIRE -432 112 -624 112
WIRE -272 112 -432 112
WIRE 32 112 32 -16
WIRE 304 128 304 -16
WIRE 384 128 384 32
WIRE -272 144 -272 112
WIRE 256 144 256 -16
WIRE 448 144 448 -16
WIRE 512 144 448 144
WIRE -624 160 -624 112
WIRE 96 160 96 64
WIRE 448 160 448 144
WIRE -432 192 -592 192
WIRE -816 208 -816 -16
WIRE -688 208 -688 112
WIRE 304 208 384 128
WIRE 384 208 304 128
WIRE 32 224 32 208
WIRE 32 224 -48 224
WIRE 96 224 96 160
WIRE 512 224 448 224
WIRE 448 240 448 224
WIRE 32 256 32 224
WIRE 256 256 256 224
WIRE 256 256 128 256
WIRE 256 272 256 256
WIRE -624 288 -624 224
WIRE -432 288 -432 272
WIRE -816 304 -816 288
WIRE -816 304 -944 304
WIRE 512 304 448 304
WIRE 384 320 384 208
WIRE -944 336 -944 304
WIRE -816 336 -816 304
WIRE -384 352 -384 80
WIRE 96 368 96 288
WIRE 256 368 256 352
WIRE 256 368 96 368
WIRE 304 368 304 208
WIRE 304 368 256 368
WIRE 448 368 400 368
WIRE -272 384 -272 224
WIRE -272 384 -352 384
WIRE -176 384 -272 384
WIRE 32 384 32 336
WIRE 32 384 -176 384
WIRE 96 400 96 368
WIRE -816 480 -816 400
WIRE -384 480 -384 416
WIRE -96 480 -96 80
WIRE 48 480 -96 480
WIRE -688 512 -688 288
WIRE -688 512 -784 512
WIRE -656 512 -688 512
WIRE -272 512 -272 464
WIRE -272 512 -576 512
WIRE -176 512 -176 464
WIRE -176 512 -272 512
WIRE 96 512 96 496
WIRE 96 512 -176 512
WIRE 96 528 96 512
WIRE -816 608 -816 544
WIRE -944 624 -944 400
WIRE -48 656 -48 224
WIRE -48 656 -912 656
WIRE -944 752 -944 688
FLAG -384 480 0
FLAG 96 608 0
FLAG -432 288 0
FLAG -624 288 0
FLAG -48 -48 0
FLAG -816 608 0
FLAG -944 752 0
SYMBOL TLV431 -384 384 R0
SYMATTR InstName U1
SYMBOL res 80 512 R0
SYMATTR InstName R1
SYMATTR Value 1
SYMBOL res -368 80 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R4
SYMATTR Value 3.3K
SYMBOL voltage -48 -144 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V1
SYMATTR Value 5
SYMBOL res -192 480 M180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R2
SYMATTR Value 68K
SYMBOL res -256 240 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R3
SYMATTR Value 150k
SYMBOL cap 464 160 M0
SYMATTR InstName C1
SYMATTR Value 1
SYMBOL cap 464 240 M0
SYMATTR InstName C2
SYMATTR Value 1
SYMBOL cap 464 304 M0
SYMATTR InstName C3
SYMATTR Value 1
SYMBOL TLV431 -624 192 R0
SYMATTR InstName U3
SYMBOL res -416 288 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R8
SYMATTR Value 68K
SYMBOL res -608 128 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R9
SYMATTR Value 220
SYMBOL res -416 96 M0
SYMATTR InstName R10
SYMATTR Value 150K
SYMBOL res -288 480 M180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R11
SYMATTR Value 360K
SYMBOL TLV431 96 256 R0
SYMATTR InstName U4
SYMBOL res 272 128 M0
SYMATTR InstName R6
SYMATTR Value 36K
SYMBOL res 272 256 M0
SYMATTR InstName R7
SYMATTR Value 15K
SYMBOL pnp 96 208 R180
SYMATTR InstName Q1
SYMATTR Value BC857B
SYMBOL res 80 80 M180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R12
SYMATTR Value 3.3K
SYMBOL PSMN069-100YS 48 400 R0
SYMATTR InstName U2
SYMBOL res 496 128 R0
SYMATTR InstName R13
SYMATTR Value 10meg
SYMBOL res 496 208 R0
SYMATTR InstName R14
SYMATTR Value 10meg
SYMBOL pmos 304 32 R270
SYMATTR InstName M1
SYMATTR Value RSQ035P03
SYMBOL PSMN069-100YS 304 320 M90
SYMATTR InstName U5
SYMBOL TLV431 -816 512 R0
SYMATTR InstName U6
SYMBOL res -800 304 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R15
SYMATTR Value 220
SYMBOL LED -832 336 R0
SYMATTR InstName D1
SYMATTR Value NSCW100
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL res -672 304 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R16
SYMATTR Value 360K
SYMBOL res -560 496 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 150K
SYMBOL res 48 240 M0
SYMATTR InstName R17
SYMATTR Value 68K
SYMBOL LED -960 336 R0
SYMATTR InstName D2
SYMATTR Value NSCW100
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL TLV431 -944 656 R0
SYMATTR InstName U7
TEXT 504 0 Left 2 !;op
TEXT 504 -24 Left 2 !.tran 0 10 0.01 uic
TEXT -816 -304 Left 2 ;Reference voltage set at 4.0V: needed, so that charging current is less dependent on supply voltage: R8, R9, R10, U3
TEXT -816 -280 Left 2 ;Charge current control set at 200mA: R1, R2, R3, R4, R11, U1, U2
TEXT -816 -256 Left 2 ;Overvoltage protection set at 4.2V: R6, R7, R12, U4, Q1
TEXT -816 -232 Left 2 ;Charger disconnect protection: protects the charger, containing charged batteries, when not connected to the power supply: M1, U5
TEXT -816 -208 Left 2 ;Batteries that must be charged (simple spice model): C1, C2, C3
TEXT -816 -184 Left 2 ;Components to suppress Spice warnings: R13, R14
TEXT -816 -88 Left 2 ;U2, U5, M1: can be any low RdsOn, low Vth. MOSFET
TEXT -816 -160 Left 2 ;Charging ongoing LED indicator: R5, R15, R16, D1, U6.
TEXT -816 -328 Left 2 ;Supply voltage V1: [4.5 5.5] V : meant for USB-port, connect D- to D+ of USB connector.
TEXT -816 -136 Left 2 ;Charging finished LED indicator: R15, D2, U7
TEXT -816 -64 Left 2 ;D1, D2 can be part of an RGB-LED, e.g. Nichia NECM325-C
